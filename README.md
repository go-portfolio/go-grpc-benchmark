# üß† go-grpc-benchmark

**go-grpc-benchmark** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ **gRPC-—Å–µ—Ä–≤–∏—Å–æ–≤** –Ω–∞ —è–∑—ã–∫–µ **Go**.  
–û–Ω –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Prometheus) –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É (OpenTelemetry + Jaeger).

---

## üìò –û –ø—Ä–æ–µ–∫—Ç–µ

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π gRPC-—Å–µ—Ä–≤–∏—Å–æ–≤.  
–ü—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä;
- –∏–∑–º–µ—Ä—è—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∏, TPS, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/RAM;
- —Å–æ–±–∏—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ **Prometheus**;
- –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ç—Ä–∞—Å—Å—ã –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ **OpenTelemetry / Jaeger**.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîÅ –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–µ —Ç–µ—Å—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ –∫ gRPC-—Å–µ—Ä–≤–µ—Ä—É  
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ—Ç–æ–∫–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π  
- üìä –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ Prometheus (–∑–∞–¥–µ—Ä–∂–∫–∏, —Ä–∞–∑–º–µ—Ä—ã, –æ—à–∏–±–∫–∏, TPS)  
- üîé –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ OpenTelemetry  
- üß© –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ (`light`, `peak`, `constant`)  
- üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∞ –≤ VS Code 

## üß± –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Go-–∫–æ–¥–∞ –∏–∑ `.proto`
```bash
$ protoc \
  --go_out=. --go_opt=paths=source_relative \
  --go-grpc_out=. --go-grpc_opt=paths=source_relative \
  proto/benchmark.proto
```

## –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
go run cmd/server/main.go

## –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç –±–µ–Ω—á–º–∞—Ä–∫–∞
go run cmd/client/main.go

‚úÖ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å debug:

–ó–∞–ø—É—Å–∫ —Å —Ñ–ª–∞–≥–æ–º:
```bash
go run cmd/server/main.go -debug -verbose 
```

## ‚öôÔ∏è –û—Ç–ª–∞–¥–∫–∞ –≤ VS Code (`launch.json`)

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ—Ç–ª–∞–¥–∫–∏ –≤ Visual Studio Code.  
–§–∞–π–ª `launch.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞ gRPC-–±–µ–Ω—á–º–∞—Ä–∫–∞.

* **–§–ª–∞–≥–∏ (`-debug`, `--verbose`)** –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `main` —Ç–æ–ª—å–∫–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è).
* **–û—Ç–ª–∞–¥—á–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Ñ–ª–∞–≥–æ–≤** ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞ –≤ –∫–æ–¥–µ.
* –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –∏–∑ VS Code:

| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è              | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                        | –ê—Ä–≥—É–º–µ–Ω—Ç—ã         |
| ------------------------- | ------------------------------------------------- | ----------------- |
| **Debug Server**          | –ó–∞–ø—É—Å–∫–∞–µ—Ç gRPC —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏            | `-debug -verbose` |
| **Debug Client**          | –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ | `-debug -verbose` |
| **Debug Server + Client** | –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –æ–±–µ–∏—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π           | ‚Äî                 |


–§–ª–∞–≥–∏ –∑–¥–µ—Å—å –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Ç–ª–∞–¥—á–∏–∫–∞, –∞ —Å–ª—É–∂–∞—Ç –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.


## CLI-—Ñ–ª–∞–≥–∏

| –§–ª–∞–≥       | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                      |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------- |
| `-debug`   | –í–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏. –í—Å–µ –≤—ã–∑–æ–≤—ã `logDebug` –≤—ã–≤–æ–¥—è—Ç –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.                          |
| `-verbose` | –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞. –í—Å–µ –≤—ã–∑–æ–≤—ã `logVerbose` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º RPC, –æ—Ç–≤–µ—Ç–∞—Ö –∏ –æ—à–∏–±–∫–∞—Ö. |

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞:

### –°–µ—Ä–≤–µ—Ä —Å —Ä–µ–∂–∏–º–æ–º –æ—Ç–ª–∞–¥–∫–∏
go run cmd/server/main.go -debug

### –ö–ª–∏–µ–Ω—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
go run cmd/client/main.go -verbose


–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å -debug –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π, –∞ -verbose –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–æ–≤ –∏ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤.

## gRPC Benchmark Server Methods

–ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ –º–µ—Ç–æ–¥—ã —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

| –ú–µ—Ç–æ–¥                  | –¢–∏–ø RPC                  | –û–ø–∏—Å–∞–Ω–∏–µ                                                                 |
|------------------------|--------------------------|--------------------------------------------------------------------------|
| `Ping`                 | Unary                    | –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ (—ç—Ö–æ). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ RPC. |
| `Stats`                | Unary                    | –ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. |
| `PushNotifications`    | Server Streaming         | –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å, —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –≤–µ—â–∞–Ω–∏—è –∏–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞. |
| `AggregatePing`        | Client Streaming         | –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥. –°–µ—Ä–≤–µ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤. |
| `StreamPing`           | Bidirectional Streaming  | –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–µ—Ä–≤–µ—Ä —Å—Ä–∞–∑—É –æ—Ç–≤–µ—á–∞–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —á–∞—Ç–∞ –∏–ª–∏ –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. |


## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ TLS / mTLS
## –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

### 1Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º CA (—Ü–µ–Ω—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É ``cmd/server/certs``
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ

```bash
# –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á CA
openssl genrsa -out ca.key 4096

# –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç CA (–ø—É–±–ª–∏—á–Ω—ã–π)
openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 -subj "/CN=Test-CA" -out ca.crt
```
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã `ca.crt` –∏ `ca.key` –≤ –ø–∞–ø–∫—É ``cmd/client/certs``


### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å SAN
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É ``cmd/server/certs``
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞
openssl genrsa -out server.key 4096

# CSR —Å –∫–æ–Ω—Ñ–∏–≥–æ–º
openssl req -new -key server.key -out server.csr -config server-openssl.cnf

# –ü–æ–¥–ø–∏—Å–∞—Ç—å —É CA —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏
openssl x509 -req -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial \
  -out server.crt -days 365 -extensions v3_req -extfile server-openssl.cnf

```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ —Å SAN
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É ``cmd/client/certs``
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã
```bash
# –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞
openssl genrsa -out client.key 4096

# CSR —Å –∫–æ–Ω—Ñ–∏–≥–æ–º
openssl req -new -key client.key -out client.csr -config client-openssl.cnf

# –ü–æ–¥–ø–∏—Å–∞—Ç—å —É CA —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏
openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial \
  -out client.crt -days 365 -extensions v3_req -extfile client-openssl.cnf

```

## Load Testing (–ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

–ö–ª–∏–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è gRPC —Å–µ—Ä–≤–∏—Å–∞ —Å –∑–∞–º–µ—Ä–æ–º **latency** (p50, p90, p99) –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `requests` ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–æ–æ–±—â–µ–Ω–∏–π  
- `concurrency` ‚Äì —á–∏—Å–ª–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω  
- `scenario` ‚Äì —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏: `light`, `peak`, `constant`  

**–°—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏:**

- `light` ‚Äì –ª—ë–≥–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ (~100‚ÄØ–º—Å)  
- `peak` ‚Äì –ø–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –∫–æ—Ä–æ—Ç–∫–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –ø–∞—É–∑–∞ (~0‚Äì10‚ÄØ–º—Å)  
- `constant` ‚Äì –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞, –±–µ–∑ –ø–∞—É–∑  

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```go
// –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
requests := 1000
concurrency := 50
scenario := client.ScenarioPeak

client.UnaryPing(c, requests, concurrency, scenario)
client.StreamPing(c, 100, concurrency, scenario)
client.PushNotifications(c, "start", concurrency, scenario)
client.AggregatePing(c, 50, concurrency, scenario)
```

## Prometheus –º–µ—Ç—Ä–∏–∫–∏

–ù–∞—à gRPC —Å–µ—Ä–≤–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Prometheus –∏ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

### 1. –ú–µ—Ç—Ä–∏–∫–∏ gRPC –∑–∞–ø—Ä–æ—Å–æ–≤

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–µ–π–±–ª—ã |
|---------|-----|----------|--------|
| `grpc_rpc_requests_total` | Counter | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ gRPC –∑–∞–ø—Ä–æ—Å–æ–≤ | `method` ‚Äì –∏–º—è –º–µ—Ç–æ–¥–∞, `status` ‚Äì `success` –∏–ª–∏ `error` |
| `grpc_rpc_latency_seconds` | Histogram | –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ gRPC –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–µ–∫—É–Ω–¥—ã) | `method` ‚Äì –∏–º—è –º–µ—Ç–æ–¥–∞ |
| `grpc_rpc_request_size_bytes` | Histogram | –†–∞–∑–º–µ—Ä gRPC –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–π—Ç–∞—Ö | `method` ‚Äì –∏–º—è –º–µ—Ç–æ–¥–∞ |
| `grpc_rpc_response_size_bytes` | Histogram | –†–∞–∑–º–µ—Ä gRPC –æ—Ç–≤–µ—Ç–æ–≤ –≤ –±–∞–π—Ç–∞—Ö | `method` ‚Äì –∏–º—è –º–µ—Ç–æ–¥–∞ |

> –≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä—ã `PrometheusUnaryInterceptor` –∏ `PrometheusStreamInterceptor` –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞.

---

### 2. –î–æ—Å—Ç—É–ø –∫ –º–µ—Ç—Ä–∏–∫–∞–º

–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ HTTP —ç–Ω–¥–ø–æ–∏–Ω—Ç—É:
```
http://localhost:9090/metrics
```

- –î–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ Prometheus –∏–ª–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Grafana.
- –ú–µ—Ç—Ä–∏–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–æ–≤ gRPC.


## OpenTelemetry (Tracing)

–°–µ—Ä–≤–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å **OpenTelemetry** –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ gRPC –∑–∞–ø—Ä–æ—Å–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—ç–∫—Å–ø–æ—Ä—Ç–µ—Ä Jaeger**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Å—Å—ã –∏ –∏–∑–º–µ—Ä—è—Ç—å latency –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenTelemetry

- –≠–∫—Å–ø–æ—Ä—Ç–µ—Ä: **Jaeger Collector**
- –ê–¥—Ä–µ—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `http://localhost:14268/api/traces`
- –°–µ—Ä–≤–∏—Å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: `grpc-benchmark-server`
- –ö–∞–∂–¥—ã–π RPC –≤—ã–∑–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç **span** —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–µ—Ç–æ–¥–µ, —Å—Ç–∞—Ç—É—Å–µ –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.


–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç—Ä–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Jaeger UI:
```
http://localhost:16686
```

## ü™µ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É `logs`.
–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

`server.log` ‚Äî –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã gRPC —Å–µ—Ä–≤–µ—Ä–∞

`client.log` ‚Äî –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞ (–±–µ–Ω—á–º–∞—Ä–∫–∞)

–õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —Å—Ç–∞—Ç—É—Å–∞—Ö RPC, –æ—à–∏–±–∫–∞—Ö –∏ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø—Ä–∏ –≤–∫–ª—é—á—ë–Ω–Ω—ã—Ö —Ñ–ª–∞–≥–∞—Ö -debug –∏–ª–∏ -verbose.
